(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42259,       1155]
NotebookOptionsPosition[     38359,       1090]
NotebookOutlinePosition[     38721,       1106]
CellTagsIndexPosition[     38678,       1103]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Exoplanet Analytic Reflected Lightcurves (EARL)", "Chapter",
 CellChangeTimes->{{3.726941713651931*^9, 3.726941728311996*^9}, {
   3.726942041509684*^9, 3.726942082573065*^9}, 
   3.726943200808971*^9},ExpressionUUID->"7d950af7-b37c-46fa-86e2-\
d8143dc7aa95"],

Cell[TextData[{
 "This Mathematica notebook allows you to compute the analytic form of a \
reflected lightcurve given a spherical harmonic decomposition of the planet \
albedo map and the viewing and orbital geometries. The theoretical foundation \
for this code is laid out in the paper \[OpenCurlyDoubleQuote]Analytic \
Reflected Lightcurves for Exoplanets\[CloseCurlyDoubleQuote] by Hal M. \
Haggard and Nicolas B. Cowan, which can be found ",
 Cell[BoxData[
  TemplateBox[{"\"on the arXiv\"","https://arxiv.org/abs/1802.02075"},
   "HyperlinkURL"]],ExpressionUUID->"6040dd70-f179-44fe-8265-65a5546a9904"],
 ". "
}], "Text",
 CellChangeTimes->{{3.726941767915625*^9, 3.726941780136037*^9}, {
  3.7269418964079237`*^9, 3.726941938754323*^9}, {3.726941973758411*^9, 
  3.7269419789177*^9}, {3.7269420964936733`*^9, 3.726942126814209*^9}, {
  3.726942215887023*^9, 3.726942230007798*^9}, {3.7269422956048822`*^9, 
  3.7269423216790543`*^9}, {3.726942398960642*^9, 3.726942399411175*^9}, {
  3.726942574380471*^9, 3.726942589622493*^9}, {3.726942644187417*^9, 
  3.726942652743621*^9}, {3.726942788065652*^9, 3.726942811166452*^9}, {
  3.726943145073523*^9, 3.726943175059231*^9}, {3.7269572882220163`*^9, 
  3.72695729985892*^9}},ExpressionUUID->"225c1307-c42a-45d1-8519-\
d1ee2f794421"],

Cell[TextData[{
 "The main body of the code is all contained within the next cell. Once it \
has been initialized, the cell can be minimized. \n\nThe code makes available \
the function Fcurv[l,m,\[Alpha],\[Beta],\[Gamma],w]. This function gives an \
analytic formula for the lightcurve corresponding to the spherical harmonic \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["Y", "l"], "m"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c9e2558b-9775-4fbe-9c7b-145543e1a557"],
 ". The first two arguments of Fcurv specify the degree (l-index) and the \
order (m-index). The next three arguments \[Alpha], \[Beta], and \[Gamma] are \
the Euler angles of a specific rotation connected to the viewing and orbital \
geometries. These Euler angles are specified in terms of the subobserver and \
substellar points below. Finally w is the angular width of the lune on the \
planet surface that is both visible and illuminated. The time-dependence of \
the lightcurve comes in through these final four arguments. \n\nThe current \
version of this code only goes so far as to express the lightcurve in terms \
of the subobserver and substellar points. However, the paper referenced above \
has all the formulas necessary to reach the final explicit time-dependence \
for an arbitrary geometry, see Appendix C. For a few more technical comments \
on conventions see the Section \[OpenCurlyDoubleQuote]Conventions\
\[CloseCurlyDoubleQuote] at the end of this notebook. "
}], "Text",
 CellChangeTimes->{{3.726943252329194*^9, 3.726943316328744*^9}, {
  3.7269437749740543`*^9, 3.726943804179413*^9}, {3.726944448161525*^9, 
  3.726944556811236*^9}, {3.726944734986874*^9, 3.726944929607335*^9}, {
  3.726944982697287*^9, 3.7269451186072474`*^9}, {3.726946463055375*^9, 
  3.726946490250763*^9}},ExpressionUUID->"d5ae253c-84f4-4fa7-82c6-\
79023e1ba74c"],

Cell[CellGroupData[{

Cell["Main code for EARL", "Section",
 CellChangeTimes->{{3.678172416592833*^9, 3.678172424364657*^9}, {
  3.726943392900325*^9, 
  3.726943399153757*^9}},ExpressionUUID->"4a252178-b1e8-429c-b40e-\
5c4a73bb93d5"],

Cell["Complete integrals of the associated Legendre Polynomials:", "Text",
 CellChangeTimes->{{3.557365531871769*^9, 
  3.5573655542720423`*^9}},ExpressionUUID->"88dce3f9-2cff-47e7-9e43-\
74c5d546c9ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rev", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"l", "\[Equal]", "m", "\[Equal]", "0"}]}], "}"}], "}"}], ",", 
    " ", 
    FractionBox[
     RowBox[{"2", "  ", 
      RowBox[{"Abs", "[", "m", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["l", "2"], ")"}], "!"}], ")"}], "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "+", "m"}], ")"}], "!"}]}], 
     RowBox[{"l", " ", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"l", "-", "m"}], ")"}], "2"], ")"}], "!"}], " ", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"l", "+", "m"}], ")"}], "2"], ")"}], "!"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "+", "1"}], ")"}], "!"}]}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.557361889086606*^9, 3.557361937414322*^9}, {
  3.557361979366578*^9, 3.557362045959206*^9}, {3.678178251477963*^9, 
  3.67817825385105*^9}, {3.6781787848865547`*^9, 3.6781787910724916`*^9}, {
  3.6781788839574614`*^9, 3.678178885317024*^9}, {3.6781789198769703`*^9, 
  3.678178922139524*^9}, {3.696849691682461*^9, 3.6968497508945923`*^9}, {
  3.696849827172619*^9, 3.6968498300609083`*^9}, {3.696854299334221*^9, 
  3.6968543011289587`*^9}, {3.696854352276299*^9, 
  3.696854371084845*^9}},ExpressionUUID->"64f8d0fd-0262-4262-b840-\
c240fb2e1ce9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rodd", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"-", " ", 
   FractionBox[
    RowBox[{"\[Pi]", "  ", "m", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "+", "m"}], ")"}], "!"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "+", "1"}], ")"}], "!"}]}], 
    RowBox[{"l", " ", 
     SuperscriptBox["2", 
      RowBox[{
       RowBox[{"2", " ", "l"}], "+", "1"}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}], "2"], ")"}], "!"}], ")"}], "2"], 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"l", "-", "m"}], ")"}], "2"], "!"}], 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"l", "+", "m"}], ")"}], "2"], "!"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.557362208147571*^9, 3.557362338605825*^9}, {
  3.678178282173707*^9, 3.678178283896837*^9}, {3.6781784440425797`*^9, 
  3.678178446381775*^9}, {3.678178799234334*^9, 3.678178799512581*^9}, {
  3.678178943992816*^9, 3.678178975921061*^9}, {3.696850447728177*^9, 
  3.696850448590076*^9}, {3.6968513777996902`*^9, 
  3.696851379233644*^9}},ExpressionUUID->"dfb41ad3-7226-47bd-996a-\
5d9b0d1e601e"],

Cell["\<\
There's a subtlety when using these R functions to obtain the script P \
coefficients in the paper and used below. The recursion relation for the \
Legendre polynomials works for all l and m, because if m goes outside of its \
allowed range then the Legendre polynomial just vanishes and you get a valid \
formula. This is not true of the constants Rev and Rodd. You have to be sure \
to modify their contributions to the recursion relation when m goes outside \
its allowed range. The modified forms that take all of these issues into \
account are:\
\>", "Text",
 CellChangeTimes->{{3.693149289694664*^9, 3.6931493182130823`*^9}, {
  3.696846901021085*^9, 3.696846975144079*^9}, {3.726772993469998*^9, 
  3.726773000985923*^9}, {3.72677305127866*^9, 3.726773123078473*^9}, {
  3.72694352970043*^9, 
  3.726943534576899*^9}},ExpressionUUID->"72a8a5a1-beb2-4e17-ac70-\
cd6f4a5b04ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PTev", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], 
            RowBox[{
             RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
           RowBox[{"Rev", "[", 
            RowBox[{
             RowBox[{"l", "+", "2"}], ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"4", " ", "l"}], "+", "2"}], 
            RowBox[{" ", 
             RowBox[{
              RowBox[{"2", " ", "l"}], "+", "3"}]}]], 
           RowBox[{"Rev", "[", 
            RowBox[{"l", ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "+", 
          RowBox[{"Rev", "[", 
           RowBox[{
            RowBox[{"l", "-", "2"}], ",", 
            RowBox[{"m", "+", "2"}]}], "]"}]}], ")"}]}], ",", 
       RowBox[{"m", "\[LessEqual]", " ", 
        RowBox[{"l", "-", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], 
            RowBox[{
             RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
           RowBox[{"Rev", "[", 
            RowBox[{
             RowBox[{"l", "+", "2"}], ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"4", " ", "l"}], "+", "2"}], 
            RowBox[{" ", 
             RowBox[{
              RowBox[{"2", " ", "l"}], "+", "3"}]}]], 
           RowBox[{"Rev", "[", 
            RowBox[{"l", ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"l", "-", "4"}], "<", "m", "\[LessEqual]", " ", 
        RowBox[{"l", "-", "2"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", "l"}], "-", "1"}], 
           RowBox[{
            RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
          RowBox[{"Rev", "[", 
           RowBox[{
            RowBox[{"l", "+", "2"}], ",", 
            RowBox[{"m", "+", "2"}]}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"l", "-", "2"}], "<", "m", "\[LessEqual]", " ", "l"}]}], 
      "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.693598553744567*^9, {3.693598658097576*^9, 3.6935987602595873`*^9}, {
   3.696847559244322*^9, 3.696847563103105*^9}, 3.6968508216989603`*^9, 
   3.6968509234104137`*^9, {3.725033096536121*^9, 
   3.7250331090917463`*^9}},ExpressionUUID->"0833dca3-fd81-4134-9792-\
bf36e1c203cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PTodd", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], 
            RowBox[{
             RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
           RowBox[{"Rodd", "[", 
            RowBox[{
             RowBox[{"l", "+", "2"}], ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"4", " ", "l"}], "+", "2"}], 
            RowBox[{" ", 
             RowBox[{
              RowBox[{"2", " ", "l"}], "+", "3"}]}]], 
           RowBox[{"Rodd", "[", 
            RowBox[{"l", ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "+", 
          RowBox[{"Rodd", "[", 
           RowBox[{
            RowBox[{"l", "-", "2"}], ",", 
            RowBox[{"m", "+", "2"}]}], "]"}]}], ")"}]}], ",", 
       RowBox[{"m", "\[LessEqual]", " ", 
        RowBox[{"l", "-", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], 
            RowBox[{
             RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
           RowBox[{"Rodd", "[", 
            RowBox[{
             RowBox[{"l", "+", "2"}], ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"4", " ", "l"}], "+", "2"}], 
            RowBox[{" ", 
             RowBox[{
              RowBox[{"2", " ", "l"}], "+", "3"}]}]], 
           RowBox[{"Rodd", "[", 
            RowBox[{"l", ",", 
             RowBox[{"m", "+", "2"}]}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"l", "-", "4"}], "<", "m", "\[LessEqual]", " ", 
        RowBox[{"l", "-", "2"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Pi]"], 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "1"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
          RowBox[{"4", "\[Pi]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "m"}], ")"}], "!"}]}]]], " ", " ", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}], "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", "l"}], "-", "1"}], 
           RowBox[{
            RowBox[{"2", " ", "l"}], " ", "+", "3"}]], " ", 
          RowBox[{"Rodd", "[", 
           RowBox[{
            RowBox[{"l", "+", "2"}], ",", 
            RowBox[{"m", "+", "2"}]}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"l", "-", "2"}], "<", "m", "\[LessEqual]", " ", "l"}]}], 
      "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.693598553744567*^9, {3.693598658097576*^9, 3.6935987602595873`*^9}, {
   3.696847559244322*^9, 3.696847563103105*^9}, 3.6968508216989603`*^9, 
   3.6968509234104137`*^9, {3.6968514567861567`*^9, 3.69685150763901*^9}, 
   3.6968517619264708`*^9, {3.725033130047742*^9, 
   3.725033139355166*^9}},ExpressionUUID->"2449b6b9-413f-422c-a711-\
13534025f08b"],

Cell["\<\
We can combine these into a single function that checks the input values of l \
and m. \
\>", "Text",
 CellChangeTimes->{{3.696851765095463*^9, 3.696851790461334*^9}, 
   3.6968519603500347`*^9, {3.6968525033542337`*^9, 3.6968525159675293`*^9}, {
   3.6968534381453876`*^9, 3.6968534875331707`*^9}, {3.724763328810442*^9, 
   3.7247633305388737`*^9}, {3.726773146718862*^9, 
   3.7267731590812263`*^9}},ExpressionUUID->"100fa8e5-d928-4f98-bf4c-\
0f3dd4205203"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PT", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"OddQ", "[", 
        RowBox[{"l", "+", "m"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PTev", "[", 
        RowBox[{"l", ",", "m"}], "]"}], ",", 
       RowBox[{
        RowBox[{"EvenQ", "[", "l", "]"}], "&&", 
        RowBox[{"EvenQ", "[", "m", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PTodd", "[", 
        RowBox[{"l", ",", "m"}], "]"}], ",", 
       RowBox[{
        RowBox[{"OddQ", "[", "l", "]"}], "&&", 
        RowBox[{"OddQ", "[", "m", "]"}]}]}], "}"}]}], "}"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.696851792388995*^9, 3.6968518366378803`*^9}, {
  3.6968518685386477`*^9, 
  3.696851953970379*^9}},ExpressionUUID->"2f69b955-1c1e-46e9-81eb-\
ab8943ee2305"],

Cell["\<\
Similarly it is useful to break the Phi integral up into cases\
\>", "Text",
 CellChangeTimes->{{3.715966121642186*^9, 3.715966134939971*^9}, {
  3.726773187094561*^9, 
  3.726773195841045*^9}},ExpressionUUID->"037e56c2-fc41-4fb9-bb73-\
4d7bbe518d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Int", "[", 
   RowBox[{"m_", ",", "w_"}], "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", "w", "]"}], "-", " ", 
           RowBox[{"w", " ", 
            RowBox[{"Cos", "[", "w", "]"}]}]}], ")"}]}], ",", 
        RowBox[{"m", "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "w"}]], 
         RowBox[{"(", 
          RowBox[{"w", "-", 
           RowBox[{
            RowBox[{"Cos", "[", "w", "]"}], " ", 
            RowBox[{"Sin", "[", "w", "]"}]}]}], ")"}]}], ",", 
        RowBox[{"m", "\[Equal]", 
         RowBox[{"-", "2"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "w"}]], 
         RowBox[{"(", 
          RowBox[{"w", "-", 
           RowBox[{
            RowBox[{"Cos", "[", "w", "]"}], " ", 
            RowBox[{"Sin", "[", "w", "]"}]}]}], ")"}]}], ",", 
        RowBox[{"m", "\[Equal]", "2"}]}], "}"}]}], "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       RowBox[{"Cos", "[", "w", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "m", " ", "w"}]]}], ")"}]}], "-", 
      RowBox[{"m", " ", 
       RowBox[{"Sin", "[", "w", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "m", " ", "w"}]]}], ")"}]}]}], 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", "4"}], ")"}]}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.678424568977482*^9, 3.6784248136602488`*^9}, {
  3.678424872082299*^9, 3.6784248723045053`*^9}, {3.678425698107532*^9, 
  3.678425699087453*^9}},ExpressionUUID->"c1e94864-f161-490f-929c-\
0d7b8fa330c4"],

Cell["\<\
Mathematica has a funny phase convention for the Wigner D-matrices, so we \
convert to our convention by working with WignerD[{l,m,mp}, -\[Alpha], -\
\[Beta], -\[Gamma]]. Because it isn\[CloseCurlyQuote]t easy to tell \
Mathematica that the Euler angles are all real, we also use the symmetry \
Conjugate[WignerD[{l,m,mp},-\[Alpha],-\[Beta],-\[Gamma]] ]= \
(-1)^(mp-m)WignerD[{l,-m,-mp},-\[Alpha],-\[Beta],-\[Gamma]] to avoid complex \
conjugation.\
\>", "Text",
 CellChangeTimes->{{3.726771926504593*^9, 3.726771993197588*^9}, {
  3.7267720617994843`*^9, 3.726772120228745*^9}, {3.7269453927352467`*^9, 
  3.726945494224524*^9}},ExpressionUUID->"8564fdb5-9670-4304-8898-\
e416bfcfbe18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fcurv", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_", ",", 
    "w_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"mp", "-", "m"}]], " ", 
     RowBox[{"WignerD", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"-", "m"}], ",", 
         RowBox[{"-", "mp"}]}], "}"}], ",", 
       RowBox[{"-", "\[Alpha]"}], ",", 
       RowBox[{"-", "\[Beta]"}], ",", 
       RowBox[{"-", "\[Gamma]"}]}], "]"}], " ", 
     RowBox[{"PT", "[", 
      RowBox[{"l", ",", "mp"}], "]"}], " ", 
     RowBox[{"Int", "[", 
      RowBox[{"mp", ",", "w"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"mp", ",", 
      RowBox[{"-", "l"}], ",", "l", ",", " ", "2"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.726772130904566*^9, 
  3.726772198766309*^9}},ExpressionUUID->"3ee2dd6d-45c0-4163-abea-\
c623d00bd037"]
}, Open  ]],

Cell[CellGroupData[{

Cell["An example EARL calculation", "Section",
 CellChangeTimes->{{3.726945164573408*^9, 
  3.726945192382121*^9}},ExpressionUUID->"9c14d167-b382-46b2-9e6f-\
f7cdab89232c"],

Cell[TextData[{
 "Suppose an exoplanet had an albedo map that was purely given by ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["Y", "1"], "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0af46eca-5285-4d0e-b74b-be1ebb67211b"],
 ", then the reflected lightcurve of this map would be"
}], "Text",
 CellChangeTimes->{{3.726945254683013*^9, 
  3.726945328086257*^9}},ExpressionUUID->"9847d09c-ba57-4aa2-bd05-\
214c98cd9e2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Fcurv", "[", 
   RowBox[{
   "1", ",", "0", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", 
    "w"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.726944002805492*^9, 3.7269440277320232`*^9}, {
  3.726945312465605*^9, 
  3.726945335576517*^9}},ExpressionUUID->"11af52eb-b5f3-4b7f-b92a-\
1d77a889e670"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", 
  SqrtBox[
   FractionBox["3", "\[Pi]"]], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{
    FractionBox["w", "2"], "+", "\[Gamma]"}], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    FractionBox["w", "2"], "]"}], "3"], " ", 
  RowBox[{"Sin", "[", "\[Beta]", "]"}]}]], "Output",
 CellChangeTimes->{{3.726944016812644*^9, 3.726944030526046*^9}, {
  3.7269453194607077`*^9, 
  3.726945336736395*^9}},ExpressionUUID->"1ae11602-54a6-41c1-bf00-\
35b93cfab34e"]
}, Open  ]],

Cell["\<\
For a completely arbitrary orbital and viewing geometry, the Euler angles are \
expressed in terms of the subobserver and substellar points and the lune \
width w by:\
\>", "Text",
 CellChangeTimes->{{3.72694554625924*^9, 
  3.726945605461521*^9}},ExpressionUUID->"d18ccb6b-ed28-4938-9e87-\
b725e104bc1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Alpha]", "\[Rule]", 
    RowBox[{"ArcTan", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]s", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]o", "]"}], 
        RowBox[{"Sin", "[", "\[Phi]o", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]o", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
        RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]o", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
        RowBox[{"Cos", "[", "\[Phi]s", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]s", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]o", "]"}], 
        RowBox[{"Cos", "[", "\[Phi]o", "]"}]}]}]}], "]"}]}], ",", 
   RowBox[{"\[Beta]", "\[Rule]", " ", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]o", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]s", "-", "\[Phi]o"}], "]"}]}], 
      RowBox[{"Sin", "[", "w", "]"}]], "]"}]}], ",", 
   RowBox[{"\[Gamma]", "\[Rule]", " ", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
           RowBox[{"Cos", "[", "w", "]"}]}]}]}], 
        RowBox[{"Sin", "[", "w", "]"}]]}], ",", 
      RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "]"}]}]}], "}"}]], "Input",Exp\
ressionUUID->"d219f96a-15f7-445f-91cf-436f8a3779e1"],

Cell["\<\
Note the use of the two argument ArcTan functions to ensure that \[Alpha] and \
\[Gamma] range over a full 2\[Pi] interval. \
\>", "Text",
 CellChangeTimes->{{3.726945651981686*^9, 
  3.7269457049924*^9}},ExpressionUUID->"191e429c-9179-43d6-972d-db8f54784835"],

Cell["\<\
The lune width can also be expressed in terms of the subobserver and \
subtellar points\
\>", "Text",
 CellChangeTimes->{{3.726945623829883*^9, 
  3.726945641878373*^9}},ExpressionUUID->"019b055b-2c36-4a36-ae13-\
c61b20d706a4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"w", "\[Rule]", " ", 
   RowBox[{"ArcCos", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]o", "]"}]}], " ", 
      RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]o", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]s", "-", "\[Phi]o"}], "]"}]}]}], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.726945734360518*^9, 
  3.726945750527869*^9}},ExpressionUUID->"380fa60c-bf19-42a9-8452-\
f22885cf22de"],

Cell["\<\
In our experience the simplest analytical forms result by first evaluating \
and simplifying Fcurv in terms of the Euler angles, then substituting the \
Euler angle expressions and simplifying again, and then finally substituting \
the lune width and simplifying to a final form. For high degrees (ls) and \
orders (ms), more sophisticated strategies may be necessary to arrive at \
simple analytical forms. 

So, again we have\
\>", "Text",
 CellChangeTimes->{{3.726945777441884*^9, 3.726945888667519*^9}, {
  3.726946092688674*^9, 
  3.726946148195257*^9}},ExpressionUUID->"4212738f-bab6-4010-a97a-\
09afd534fd57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Fcurv", "[", 
   RowBox[{
   "1", ",", "0", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", 
    "w"}], "]"}], "]"}]], "Input",ExpressionUUID->"2c41177c-9ac9-4c56-b056-\
0f15ba7f189d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", 
  SqrtBox[
   FractionBox["3", "\[Pi]"]], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{
    FractionBox["w", "2"], "+", "\[Gamma]"}], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    FractionBox["w", "2"], "]"}], "3"], " ", 
  RowBox[{"Sin", "[", "\[Beta]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.726945891991909*^9},ExpressionUUID->"0c9f57a5-f850-4bc0-b3ca-\
5d1159014b33"]
}, Open  ]],

Cell["Then", "Text",
 CellChangeTimes->{{3.726945893163261*^9, 
  3.726945900643052*^9}},ExpressionUUID->"cd9d55ed-3829-417e-b070-\
965b0f7527e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], " ", 
     SqrtBox[
      FractionBox["3", "\[Pi]"]], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["w", "2"], "+", "\[Gamma]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       FractionBox["w", "2"], "]"}], "3"], " ", 
     RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", 
       RowBox[{"ArcTan", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]s", "]"}], 
           RowBox[{"Sin", "[", "\[Theta]o", "]"}], 
           RowBox[{"Sin", "[", "\[Phi]o", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]o", "]"}], 
           RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
           RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]o", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]s", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]s", "]"}], 
           RowBox[{"Sin", "[", "\[Theta]o", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]o", "]"}]}]}]}], "]"}]}], ",", 
      RowBox[{"\[Beta]", "\[Rule]", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]o", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]s", "-", "\[Phi]o"}], "]"}]}], 
         RowBox[{"Sin", "[", "w", "]"}]], "]"}]}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", " ", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
              RowBox[{"Cos", "[", "w", "]"}]}]}]}], 
           RowBox[{"Sin", "[", "w", "]"}]]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "]"}]}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.726944045730689*^9, 3.726944051184379*^9}, {
   3.726944082292107*^9, 3.726944091738312*^9}, 3.726944152657839*^9, {
   3.726945902914052*^9, 3.726945910991212*^9}, {3.726945947348851*^9, 
   3.726945981331354*^9}},ExpressionUUID->"bfa0cfdc-f227-44b3-9b9e-\
f610d2c283c1"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["w", "2"], "]"}], "2"], " ", 
   SqrtBox[
    RowBox[{"3", "-", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "w", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]o", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]s", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]o", "-", "\[Phi]s"}], "]"}], "2"]}]}]]}], 
  RowBox[{"8", " ", 
   SqrtBox["\[Pi]"], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]s", "]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "w", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]s", "]"}]}]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "w", "]"}], "2"]}]}]]}]]], "Output",
 CellChangeTimes->{
  3.726945925208667*^9, {3.726945960488585*^9, 
   3.726945983616269*^9}},ExpressionUUID->"099064ae-0629-48ec-a5ac-\
897e6771dcde"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
        RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["w", "2"], "]"}], "2"], " ", 
      SqrtBox[
       RowBox[{"3", "-", 
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "w", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]o", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]o", "-", "\[Phi]s"}], "]"}], "2"]}]}]]}], 
     RowBox[{"8", " ", 
      SqrtBox["\[Pi]"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]s", "]"}], "2"], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", "w", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]s", "]"}]}]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "w", "]"}], "2"]}]}]]}]], "/.", 
    RowBox[{"{", 
     RowBox[{"w", "\[Rule]", " ", 
      RowBox[{"ArcCos", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Theta]o", "]"}]}], " ", 
         RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]o", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]s", "-", "\[Phi]o"}], "]"}]}]}], "]"}]}], "}"}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7269460099984627`*^9, 
  3.726946048122587*^9}},ExpressionUUID->"4a6994b9-9166-42f8-b6ee-\
3be7dd405d46"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  SqrtBox[
   FractionBox["3", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]o", "]"}], "+", 
    RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]o", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]o", "-", "\[Phi]s"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]o", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]s", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.726946042195198*^9, 
  3.726946053058105*^9}},ExpressionUUID->"c4838ae9-6e62-427e-bc8d-\
2653895a0e64"]
}, Open  ]],

Cell["\<\
As explained in detail in Appendix E of the paper cited above, great care \
should be used in taking tidally locked or other special symmetrical limits \
of these formulas. The Euler angles can have branch cut discontinuities. If \
you are interested in a special configuration, it is wise to first simplify \
\[Alpha], \[Beta], and \[Gamma] by hand and only then to put them into the \
general formulas. \
\>", "Text",
 CellChangeTimes->{{3.726946174603743*^9, 
  3.726946301984028*^9}},ExpressionUUID->"3a9cde67-4020-4187-98b7-\
f46b1f8b0fda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conventions", "Section",
 CellChangeTimes->{{3.726946500202044*^9, 
  3.726946504885817*^9}},ExpressionUUID->"6bc29670-f575-4dd7-b17a-\
1c39f195d720"],

Cell[TextData[{
 "There are numerous conventions that go into the spherical harmonics, the \
Wigner D-matrices, and the use of Euler angles. We summarize a few of our \
conventions here. We include the Condon-Shortley phase in our use of \
spherical harmonics, this is the default in Mathematica. For the D-matrices \
we follow a different phase convention than Mathematica\[CloseCurlyQuote]s \
default, ours is the same as that of Varshalovich , Moskalev, and Khersonskii \
\[OpenCurlyDoubleQuote]Quantum Theory of Angular Momentum\
\[CloseCurlyDoubleQuote] (World Scientific 1988). We use proper Euler angles \
with a z-y\[CloseCurlyQuote]-z\[CloseCurlyQuote]\[CloseCurlyQuote] intrinsic \
rotation convention, see e.g.  ",
 Cell[BoxData[
  TemplateBox[{
   "\"Wikipedia's article\"","https://en.wikipedia.org/wiki/Euler_angles"},
   "HyperlinkURL"]],ExpressionUUID->"d5feafff-5d87-49f0-ab00-f0bc146257ac"],
 "."
}], "Text",
 CellChangeTimes->{{3.7269465404597387`*^9, 3.726946652911099*^9}, {
  3.726946805439809*^9, 3.726946919983303*^9}, {3.7269469759991627`*^9, 
  3.726946979566087*^9}},ExpressionUUID->"38c2b839-4a9a-4447-bd87-\
d3fc2b14325c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1019, 755},
WindowMargins->{{Automatic, 149}, {-43, Automatic}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 265, 4, 69, "Chapter",ExpressionUUID->"7d950af7-b37c-46fa-86e2-d8143dc7aa95"],
Cell[848, 28, 1287, 21, 83, "Text",ExpressionUUID->"225c1307-c42a-45d1-8519-d1ee2f794421"],
Cell[2138, 51, 1886, 31, 265, "Text",ExpressionUUID->"d5ae253c-84f4-4fa7-82c6-79023e1ba74c"],
Cell[CellGroupData[{
Cell[4049, 86, 212, 4, 67, "Section",ExpressionUUID->"4a252178-b1e8-429c-b40e-5c4a73bb93d5"],
Cell[4264, 92, 202, 3, 35, "Text",ExpressionUUID->"88dce3f9-2cff-47e7-9e43-74c5d546c9ba"],
Cell[4469, 97, 1590, 44, 67, "Input",ExpressionUUID->"64f8d0fd-0262-4262-b840-c240fb2e1ce9"],
Cell[6062, 143, 1298, 38, 59, "Input",ExpressionUUID->"dfb41ad3-7226-47bd-996a-5d9b0d1e601e"],
Cell[7363, 183, 893, 15, 104, "Text",ExpressionUUID->"72a8a5a1-beb2-4e17-ac70-cd6f4a5b04ab"],
Cell[8259, 200, 4677, 142, 222, "Input",ExpressionUUID->"0833dca3-fd81-4134-9792-bf36e1c203cb"],
Cell[12939, 344, 4752, 143, 222, "Input",ExpressionUUID->"2449b6b9-413f-422c-a711-13534025f08b"],
Cell[17694, 489, 470, 9, 35, "Text",ExpressionUUID->"100fa8e5-d928-4f98-bf4c-0f3dd4205203"],
Cell[18167, 500, 954, 29, 30, "Input",ExpressionUUID->"2f69b955-1c1e-46e9-81eb-ab8943ee2305"],
Cell[19124, 531, 261, 6, 35, "Text",ExpressionUUID->"037e56c2-fc41-4fb9-bb73-4d7bbe518d08"],
Cell[19388, 539, 2298, 65, 120, "Input",ExpressionUUID->"c1e94864-f161-490f-929c-0d7b8fa330c4"],
Cell[21689, 606, 697, 12, 81, "Text",ExpressionUUID->"8564fdb5-9670-4304-8898-e416bfcfbe18"],
Cell[22389, 620, 1026, 32, 33, "Input",ExpressionUUID->"3ee2dd6d-45c0-4163-abea-c623d00bd037"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23452, 657, 172, 3, 67, "Section",ExpressionUUID->"9c14d167-b382-46b2-9e6f-f7cdab89232c"],
Cell[23627, 662, 468, 12, 35, "Text",ExpressionUUID->"9847d09c-ba57-4aa2-bd05-214c98cd9e2f"],
Cell[CellGroupData[{
Cell[24120, 678, 367, 9, 30, "Input",ExpressionUUID->"11af52eb-b5f3-4b7f-b92a-1d77a889e670"],
Cell[24490, 689, 533, 16, 58, "Output",ExpressionUUID->"1ae11602-54a6-41c1-bf00-35b93cfab34e"]
}, Open  ]],
Cell[25038, 708, 315, 7, 58, "Text",ExpressionUUID->"d18ccb6b-ed28-4938-9e87-b725e104bc1a"],
Cell[25356, 717, 1712, 46, 79, "Input",ExpressionUUID->"d219f96a-15f7-445f-91cf-436f8a3779e1"],
Cell[27071, 765, 270, 5, 35, "Text",ExpressionUUID->"191e429c-9179-43d6-972d-db8f54784835"],
Cell[27344, 772, 237, 6, 35, "Text",ExpressionUUID->"019b055b-2c36-4a36-ae13-c61b20d706a4"],
Cell[27584, 780, 603, 17, 30, "Input",ExpressionUUID->"380fa60c-bf19-42a9-8452-f22885cf22de"],
Cell[28190, 799, 626, 13, 127, "Text",ExpressionUUID->"4212738f-bab6-4010-a97a-09afd534fd57"],
Cell[CellGroupData[{
Cell[28841, 816, 247, 6, 30, "Input",ExpressionUUID->"2c41177c-9ac9-4c56-b056-0f15ba7f189d"],
Cell[29091, 824, 458, 15, 58, "Output",ExpressionUUID->"0c9f57a5-f850-4bc0-b3ca-5d1159014b33"]
}, Open  ]],
Cell[29564, 842, 146, 3, 35, "Text",ExpressionUUID->"cd9d55ed-3829-417e-b070-965b0f7527e7"],
Cell[CellGroupData[{
Cell[29735, 849, 2548, 66, 172, "Input",ExpressionUUID->"bfa0cfdc-f227-44b3-9b9e-f610d2c283c1"],
Cell[32286, 917, 1338, 41, 74, "Output",ExpressionUUID->"099064ae-0629-48ec-a5ac-897e6771dcde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33661, 963, 2014, 57, 137, "Input",ExpressionUUID->"4a6994b9-9166-42f8-b6ee-3be7dd405d46"],
Cell[35678, 1022, 736, 21, 58, "Output",ExpressionUUID->"c4838ae9-6e62-427e-bc8d-2653895a0e64"]
}, Open  ]],
Cell[36429, 1046, 555, 10, 81, "Text",ExpressionUUID->"3a9cde67-4020-4187-98b7-f46b1f8b0fda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37021, 1061, 156, 3, 67, "Section",ExpressionUUID->"6bc29670-f575-4dd7-b17a-1c39f195d720"],
Cell[37180, 1066, 1151, 20, 129, "Text",ExpressionUUID->"38c2b839-4a9a-4447-bd87-d3fc2b14325c"]
}, Open  ]]
}, Open  ]]
}
]
*)

